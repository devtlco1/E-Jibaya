# ๐ง ุฅุตูุงุญ ูุดููุฉ Check Constraint ููุฃุฏูุงุฑ

## ๐ ุงููุดููุฉ
ูุงู ููุงู ุฎุทุฃ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช:
```
new row for relation "users" violates check constraint "users_role_check"
```

## ๐ ุงูุณุจุจ
ุนุฏู ุชุทุงุจู ุจูู ุชุนุฑูู ุงูุฃุฏูุงุฑ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช ูุงูููุฏ:

### ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช (ูุจู ุงูุฅุตูุงุญ):
```sql
role VARCHAR(20) NOT NULL CHECK (role IN ('admin', 'field_agent'))
```

### ูู ุงูููุฏ:
```typescript
role: 'admin' | 'field_agent' | 'employee';  // โ 'employee' ุบูุฑ ููุฌูุฏ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
```

## โ ุงูุญู ุงููุทุจู

### 1. ุชุญุฏูุซ ูุงุนุฏุฉ ุงูุจูุงูุงุช
ุชู ุชูููุฐ ููู `fix_role_constraint.sql` ูุฅุถุงูุฉ ุฏูุฑ 'employee':
```sql
ALTER TABLE public.users ADD CONSTRAINT users_role_check 
CHECK (role IN ('admin', 'field_agent', 'employee'));
```

### 2. ุชุญุฏูุซ ุงูููุฏ ููุฏุนู ุฌููุน ุงูุฃุฏูุงุฑ
```typescript
// ุงูุขู ูุฏุนู ุฌููุน ุงูุฃุฏูุงุฑ
role: 'admin' | 'field_agent' | 'employee';
```

### 3. ุชุญุฏูุซ UserManagement.tsx
- ุฅุถุงูุฉ ุฎูุงุฑ "ููุธู" ูู ูุงุฆูุฉ ุงูุฃุฏูุงุฑ
- ุชุญุฏูุซ ุฌููุน ุงููุฑุงุฌุน ูุฏูุฑ 'employee'

### 4. ุชุญุฏูุซ AdminDashboard.tsx
- ุฅุถุงูุฉ ุฏุนู ุฏูุฑ 'employee' ูู ููุงุชุฑ ุงููุณุชุฎุฏููู
- ุชุญุฏูุซ ููุทู ุงูุตูุงุญูุงุช

## ๐ ุงููุชูุฌุฉ
- โ ุชู ุญู ูุดููุฉ Check Constraint
- โ ุงููุธุงู ูุนูู ุงูุขู ูุน ุซูุงุซุฉ ุฃุฏูุงุฑ: 'admin' ู 'field_agent' ู 'employee'
- โ ูุงุนุฏุฉ ุงูุจูุงูุงุช ูุงูููุฏ ูุชุทุงุจูุงู
- โ ูุง ุชูุฌุฏ ุฃุฎุทุงุก ูู ุงูููุฏ

## ๐ ููุงุญุธุงุช
- โ ุชู ุชูููุฐ ููู `fix_role_constraint.sql` ุจูุฌุงุญ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
- โ ุงููุธุงู ุงูุขู ูุชุณู ุจูู ูุงุนุฏุฉ ุงูุจูุงูุงุช ูุงูููุฏ
- โ ุฌููุน ุงููุธุงุฆู ุชุนูู ุจุดูู ุทุจูุนู
- โ ูููู ุฅูุดุงุก ูุณุชุฎุฏููู ุจุฌููุน ุงูุฃุฏูุงุฑ ุงูุซูุงุซุฉ

## ๐ฏ ุงูุฃุฏูุงุฑ ุงููุชุงุญุฉ ุงูุขู

### ๐จโ๐ผ ูุฏูุฑ (admin)
- ุตูุงุญูุงุช ูุงููุฉ
- ุฅุฏุงุฑุฉ ุงููุณุชุฎุฏููู
- ุนุฑุถ ุฌููุน ุงูุณุฌูุงุช
- ุฅุฏุงุฑุฉ ุงููุณุฎ ุงูุงุญุชูุงุทู
- ุนุฑุถ ุณุฌู ุงูุฃูุดุทุฉ

### ๐จโ๐ผ ููุธู (employee)
- ุนุฑุถ ูุชุนุฏูู ุงูุณุฌูุงุช
- ุฅูุดุงุก ุงูุชูุงุฑูุฑ
- ูุง ููููู ุฅุฏุงุฑุฉ ุงููุณุชุฎุฏููู
- ูุง ููููู ุนุฑุถ ุณุฌู ุงูุฃูุดุทุฉ

### ๐จโ๐ง ูุญุตู ููุฏุงูู (field_agent)
- ุฅุถุงูุฉ ุณุฌูุงุช ุฌุฏูุฏุฉ
- ุนุฑุถ ุณุฌูุงุชู ููุท
- ุฑูุน ุงูุตูุฑ ูุงููููุงุช
- ุชุญุฏูุฏ ุงููููุน ุงูุฌุบุฑุงูู

## ๐ ููุงุญุธุงุช ุฅุถุงููุฉ
- ุชู ุฅุตูุงุญ ุฎุทุฃ SQL ูู ููู `fix_role_constraint.sql`
- ุชู ุฅูุดุงุก ููู `verify_constraint.sql` ููุชุญูู ูู ุงูู constraint
- ุฌููุน ุงูุงุณุชุนูุงูุงุช ุชู ุงุฎุชุจุงุฑูุง ูุชุนูู ุจุดูู ุตุญูุญ
- ุงููุธุงู ุฌุงูุฒ ููุงุณุชุฎุฏุงู ูุน ุฌููุน ุงูุฃุฏูุงุฑ
